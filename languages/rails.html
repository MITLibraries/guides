
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Rails at MIT Libraries &#8212; Guides  documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Vue.js at MIT Libraries" href="vuejs.html" />
    <link rel="prev" title="Python Guidelines" href="python.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="rails-at-mit-libraries">
<h1>Rails at MIT Libraries<a class="headerlink" href="#rails-at-mit-libraries" title="Permalink to this headline">¶</a></h1>
<section id="style-and-conventions">
<h2>Style and Conventions<a class="headerlink" href="#style-and-conventions" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>follow <a class="reference external" href="https://github.com/bbatsov/ruby-style-guide">The Ruby Style Guide</a></p></li>
<li><p>use <a class="reference external" href="https://github.com/bbatsov/rubocop">rubocop</a> to lint before requesting
code reviews</p></li>
</ul>
</section>
<section id="test-frameworks">
<h2>Test Frameworks<a class="headerlink" href="#test-frameworks" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>We recommend <a class="reference external" href="https://github.com/seattlerb/minitest">minitest</a>, as it
generally runs faster than rspec</p></li>
</ul>
</section>
<section id="continuous-integration">
<h2>Continuous Integration<a class="headerlink" href="#continuous-integration" title="Permalink to this headline">¶</a></h2>
<p>You should use GitHub Actions. If you feel you have reason to use another
solution, ask in #engineering on Slack to get peer feedback as to confirm
whether others agree your use case differs enough to not use our common
solution.</p>
<p>To use our standard setup, do the following:</p>
<ul class="simple">
<li><p>Make a copy of
<a class="reference external" href="https://raw.githubusercontent.com/MITLibraries/bento/main/.github/workflows/ci.yml">our template</a>,
to your repo in the path <code class="docutils literal notranslate"><span class="pre">.github/workflows/ci.yml</span></code>. Update the last line of
this file to match your repo at <code class="docutils literal notranslate"><span class="pre">path-to-lcov</span></code>.</p></li>
<li><p>Ensure you are using SimpleCov and have setup LCOV as a formatter.</p>
<ul>
<li><p>Add <code class="docutils literal notranslate"><span class="pre">gem</span> <span class="pre">simplecov</span></code> and <code class="docutils literal notranslate"><span class="pre">gem</span> <span class="pre">simplecov-lcov</span></code> to your test group in your
<code class="docutils literal notranslate"><span class="pre">Gemfile</span></code>:</p></li>
</ul>
</li>
</ul>
<div class="highlight-ruby notranslate"><div class="highlight"><pre><span></span><span class="n">gem</span> <span class="s1">&#39;simplecov&#39;</span><span class="p">,</span> <span class="nb">require</span><span class="p">:</span> <span class="kp">false</span>
<span class="n">gem</span> <span class="s1">&#39;simplecov-lcov&#39;</span><span class="p">,</span> <span class="nb">require</span><span class="p">:</span> <span class="kp">false</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bundle</span> <span class="pre">install</span></code></p></li>
<li><p>Add the following to the very top of your <code class="docutils literal notranslate"><span class="pre">test/test_helper.rb</span></code></p></li>
</ul>
<div class="highlight-ruby notranslate"><div class="highlight"><pre><span></span><span class="nb">require</span> <span class="s1">&#39;simplecov&#39;</span>
<span class="nb">require</span> <span class="s1">&#39;simplecov-lcov&#39;</span>
<span class="no">SimpleCov</span><span class="o">::</span><span class="no">Formatter</span><span class="o">::</span><span class="no">LcovFormatter</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">report_with_single_file</span> <span class="o">=</span> <span class="kp">true</span>
<span class="no">SimpleCov</span><span class="o">.</span><span class="n">formatters</span> <span class="o">=</span> <span class="o">[</span>
  <span class="no">SimpleCov</span><span class="o">::</span><span class="no">Formatter</span><span class="o">::</span><span class="no">HTMLFormatter</span><span class="p">,</span>
  <span class="no">SimpleCov</span><span class="o">.</span><span class="n">formatter</span> <span class="o">=</span> <span class="no">SimpleCov</span><span class="o">::</span><span class="no">Formatter</span><span class="o">::</span><span class="no">LcovFormatter</span>
<span class="o">]</span>
<span class="no">SimpleCov</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="s1">&#39;rails&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Commit on a new branch and push your changes</p></li>
<li><p>Open a PR and your Action should run (and pass!). If not, debug or ask on our
Slack for tips.</p></li>
</ul>
</section>
<section id="rails-development-environment">
<h2>Rails Development Environment<a class="headerlink" href="#rails-development-environment" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>For local development, you will need the ENV for the app you’re working with.
Contact an engineer who’s worked on the app, and they will provide you with
the requisite .env file</p></li>
</ul>
</section>
<section id="deployments">
<h2>Deployments<a class="headerlink" href="#deployments" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>We target <a class="reference internal" href="../deploy/heroku.html"><span class="doc">Heroku</span></a> as a deployment platform and use Pipelines so custom
deployment scripts are not necessary</p></li>
</ul>
</section>
<section id="ruby-versions">
<h2>Ruby Versions<a class="headerlink" href="#ruby-versions" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>We use <a class="reference external" href="https://github.com/rbenv/rbenv">rbenv</a> to manage Ruby versions</p></li>
<li><p>Use the latest stable release unless you have a documented reason not to
(an <a class="reference external" href="https://github.com/npryce/adr-tools">ADR</a> would be a great place to
document this if the project is using them)</p></li>
<li><p>see also: <code class="docutils literal notranslate"><span class="pre">Upgrading</span> <span class="pre">Ruby</span> <span class="pre">on</span> <span class="pre">Rails</span> <span class="pre">and</span> <span class="pre">Deprecations</span></code> below</p></li>
</ul>
</section>
<section id="rails-versions">
<h2>Rails Versions<a class="headerlink" href="#rails-versions" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Use the latest</p></li>
<li><p>see also: <code class="docutils literal notranslate"><span class="pre">Upgrading</span> <span class="pre">Ruby</span> <span class="pre">on</span> <span class="pre">Rails</span> <span class="pre">and</span> <span class="pre">Deprecations</span></code> below</p></li>
</ul>
</section>
<section id="upgrading-ruby-on-rails-and-deprecations">
<h2>Upgrading Ruby on Rails and Deprecations<a class="headerlink" href="#upgrading-ruby-on-rails-and-deprecations" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>read the upstream upgrade notes. They will exist and will be useful.</p></li>
<li><p>upgrade and get stuff working. It’s okay to ignore deprecations during this
initial upgrade step</p></li>
<li><p>once everything works in the new version commit! you are not done though</p></li>
<li><p>address the deprecations now. any deprecations that are not addressed
immediately should get a ticket to remind us to go back and do it later</p></li>
<li><p>if we deal with deprecations early, upgrading versions is usually easy</p></li>
</ul>
</section>
<section id="gems-and-updates">
<h2>Gems and Updates<a class="headerlink" href="#gems-and-updates" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>subscribe to security alerts for all gems used by your project.
<a class="reference external" href="https://dependabot.com">Dependabot</a> or <a class="reference external" href="https://depfu.com">Depfu</a> are
efficient ways to do this. Keep everything up to date even after the project
is in production to avoid accumulating unnecessary technical debt.</p></li>
</ul>
</section>
<section id="layout-and-styles">
<h2>Layout and Styles<a class="headerlink" href="#layout-and-styles" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Use our <a class="reference external" href="https://github.com/MITLibraries/mitlibraries-theme">mitlibraries-theme</a> gem. See that repo for documentation.</p></li>
</ul>
</section>
<section id="authentication">
<h2>Authentication<a class="headerlink" href="#authentication" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>See our general <a class="reference internal" href="../authentication/touchstone_saml.html"><span class="doc">Touchstone</span></a> docs that include some
Rails specific information</p></li>
<li><p>Use <a class="reference external" href="https://github.com/plataformatec/devise">Devise</a>, probably with
<a class="reference external" href="https://github.com/omniauth/omniauth">OmniAuth</a></p></li>
<li><p><a class="reference external" href="https://oidc.mit.edu">MIT OpenID Pilot</a> should not be used unless it leaves pilot stage</p></li>
</ul>
</section>
<section id="authorization">
<h2>Authorization<a class="headerlink" href="#authorization" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Use <a class="reference external" href="https://github.com/CanCanCommunity/cancancan">CanCanCan</a></p></li>
</ul>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Guides</a></h1>








<h3>Navigation</h3>
<p><span class="caption-text">Start Here</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../basics/a11y.html">Accessibility / a11y</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basics/github.html">GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basics/github_desktop.html">GitHub Desktop</a></li>
</ul>
<p><span class="caption-text">How We Work Together</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../collaboration/code_review.html">Code review</a></li>
<li class="toctree-l1"><a class="reference internal" href="../collaboration/pairing.html">Pair programming</a></li>
</ul>
<p><span class="caption-text">Languages and Frameworks</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="python.html">Python Guidelines</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Rails at MIT Libraries</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#style-and-conventions">Style and Conventions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#test-frameworks">Test Frameworks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#continuous-integration">Continuous Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#rails-development-environment">Rails Development Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#deployments">Deployments</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ruby-versions">Ruby Versions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#rails-versions">Rails Versions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#upgrading-ruby-on-rails-and-deprecations">Upgrading Ruby on Rails and Deprecations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#gems-and-updates">Gems and Updates</a></li>
<li class="toctree-l2"><a class="reference internal" href="#layout-and-styles">Layout and Styles</a></li>
<li class="toctree-l2"><a class="reference internal" href="#authentication">Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="#authorization">Authorization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="vuejs.html">Vue.js at MIT Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="wordpress.html">WordPress at MIT Libraries</a></li>
</ul>
<p><span class="caption-text">Authentication</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../authentication/oauth.html">OAuth at MIT (deprecated)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authentication/touchstone_saml.html">Touchstone / Shibboleth / SAML</a></li>
</ul>
<p><span class="caption-text">Deployment</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../deploy/airflow.html">Airflow: workflow engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deploy/aws-2.0.html">AWS Organization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deploy/cicd.html">Continuous Integration/Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deploy/heroku.html">Heroku</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deploy/heroku_checklist.html">Heroku Launch Checklist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deploy/legacy-aws.html">Legacy AWS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deploy/legacy-terraform.html">Legacy Terraform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deploy/pantheon.html">Pantheon</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deploy/terraform-1.0.html">Terraform</a></li>
</ul>
<p><span class="caption-text">Everything else</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../misc/adr.html">Architecture Decision Records</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/docker.html">Containerizing Your App</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/exception_monitoring.html">Exception Monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/incident_response.html">Incident Response Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/logging.html">Central Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/matomo.html">Configuring Matomo for analytics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/proxy_urls.html">Proxy URLs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/ssl.html">SSL Encryption</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="python.html" title="previous chapter">Python Guidelines</a></li>
      <li>Next: <a href="vuejs.html" title="next chapter">Vue.js at MIT Libraries</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, MIT Libraries.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.2.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/languages/rails.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>