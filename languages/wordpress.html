
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>WordPress at MIT Libraries &#8212; Guides  documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="OAuth at MIT (deprecated)" href="../authentication/oauth.html" />
    <link rel="prev" title="Vue.js at MIT Libraries" href="vuejs.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="wordpress-at-mit-libraries">
<h1>WordPress at MIT Libraries<a class="headerlink" href="#wordpress-at-mit-libraries" title="Permalink to this headline">¶</a></h1>
<p>WordPress is one of several content management systems used at the MIT
Libraries, and forms the majority of <a class="reference external" href="https://libraries.mit.edu">libraries.mit.edu</a>.</p>
<section id="deployments">
<h2>Deployments<a class="headerlink" href="#deployments" title="Permalink to this headline">¶</a></h2>
<section id="local-deployments">
<h3>Local deployments<a class="headerlink" href="#local-deployments" title="Permalink to this headline">¶</a></h3>
<p>WordPress is used on EC2 instance VMs that are administered by the
Enterprise Services team. The Wordpress installation can be found at the
Apache site root, which is:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>/var/www/html/htdocs/
</pre></div>
</div>
<p>Other applications can also be found under <code class="docutils literal notranslate"><span class="pre">htdocs/</span></code>, including a number of
static HTML files. Full documentation of the structure of the site can be
found on the <a class="reference external" href="https://wikis.mit.edu/confluence/display/UXWS/libraries.mit.edu+-+README">UX/WS wiki</a>.</p>
</section>
<section id="cloud-deployments">
<h3>Cloud deployments<a class="headerlink" href="#cloud-deployments" title="Permalink to this headline">¶</a></h3>
<p>The Libraries have been experimenting with the Pantheon cloud platform, and
have set up <a class="reference external" href="https://dashboard.pantheon.io/organizations/35a57471-c78e-4ccf-a3f1-e8681d098e90#sites/sites">an agency account</a> to coordinate this work.
In order to join the account, first sign up for a free Pantheon account and
then contact Matt Bernhardt to be added to the agency.</p>
</section>
</section>
<section id="upgrading">
<h2>Upgrading<a class="headerlink" href="#upgrading" title="Permalink to this headline">¶</a></h2>
<p>Updates to the WordPress core, and community-contributed themes and plugins,
are largely performed using the standard process in the administrative UI.
For security purposes, however, the WordPress application is kept in a
“locked” state that prevents self-modification.</p>
<p>Scripts to lock and unlock the Wordpress network can be found on <a class="reference external" href="https://github.mit.edu/mitlibraries/wordpress_deployment">MIT’s GitHub</a>.
Running these scripts requires terminal access to each server. Questions about
this process should be directed to the Enterprise Systems team.</p>
<ol class="simple">
<li><p>Unlock WordPress</p></li>
<li><p>Apply updates via administrative UI</p></li>
<li><p>Lock WordPress</p></li>
</ol>
</section>
<section id="database-migrations">
<h2>Database migrations<a class="headerlink" href="#database-migrations" title="Permalink to this headline">¶</a></h2>
<p>At times it is necessary to move database content between tiers. For example,
we copy production content down to the staging site in order to evaluate a
significant site redesign. As part of this process, it is necessary to run a
search-and-replace tool in order to change the site address throughout the
database.</p>
<p>The WordPress CLI has a <a class="reference external" href="https://developer.wordpress.org/cli/commands/search-replace/">search-replace</a> command to accomplish this goal.
The specific flags that we use include <code class="docutils literal notranslate"><span class="pre">network</span></code>, <code class="docutils literal notranslate"><span class="pre">path</span></code>, and <code class="docutils literal notranslate"><span class="pre">url</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">wp</span> <span class="o">--</span><span class="n">network</span> <span class="o">--</span><span class="n">path</span><span class="o">=/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">htdocs</span> <span class="o">--</span><span class="n">url</span><span class="o">=</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">old</span><span class="o">.</span><span class="n">website</span><span class="o">.</span><span class="n">url</span> <span class="n">search</span><span class="o">-</span><span class="n">replace</span> <span class="n">old</span><span class="o">.</span><span class="n">website</span><span class="o">.</span><span class="n">url</span> <span class="n">new</span><span class="o">.</span><span class="n">website</span><span class="o">.</span><span class="n">url</span>
</pre></div>
</div>
</section>
<section id="locally-developed-code">
<h2>Locally Developed Code<a class="headerlink" href="#locally-developed-code" title="Permalink to this headline">¶</a></h2>
<p>While much of what we do with WordPress involves working with code that is
written elsewhere, there are times where we need to write a plugin or theme
locally.</p>
<section id="style-and-coding-conventions">
<h3>Style and Coding Conventions<a class="headerlink" href="#style-and-coding-conventions" title="Permalink to this headline">¶</a></h3>
<p>The WordPress community has adopted a set of <a class="reference external" href="https://codex.wordpress.org/WordPress_Coding_Standards">coding standards</a> to which all the
projects we develop should adhere. This includes standards for PHP, HTML, CSS,
and JavaScript.</p>
<p>For local development, we recommend using <a class="reference external" href="https://github.com/squizlabs/PHP_CodeSniffer">PHP_CodeSniffer from Squiz Labs</a> as a
linter before pushing code to GitHub. The WordPress Coding Standards have been
<a class="reference external" href="https://github.com/WordPress-Coding-Standards/WordPress-Coding-Standards">implemented for PHPCS on GitHub</a>.</p>
<p>GitHub offers integrations with Travis-CI and CodeClimate, both of which can
be used to run PHPCS and similar code analysis tools.</p>
</section>
<section id="test-frameworks">
<h3>Test Frameworks<a class="headerlink" href="#test-frameworks" title="Permalink to this headline">¶</a></h3>
<p>Because most local development at the MIT Libraries focuses on the theme
layer, testing is frequently not practical beyond linting and static code
analysis (see above).</p>
</section>
<section id="project-documentation">
<h3>Project Documentation<a class="headerlink" href="#project-documentation" title="Permalink to this headline">¶</a></h3>
<p>Documentation for a specific theme or plugin should be contained in markdown
files, inside a <code class="docutils literal notranslate"><span class="pre">docs/</span></code> directory in each repository. Where documentation is
simple enough, it can be contained only within the <code class="docutils literal notranslate"><span class="pre">readme.md</span></code> file.</p>
</section>
<section id="upgrading-local-projects">
<h3>Upgrading Local Projects<a class="headerlink" href="#upgrading-local-projects" title="Permalink to this headline">¶</a></h3>
<p>You will need terminal access to the server, and your account should have git
and node available. We recommend creating a <code class="docutils literal notranslate"><span class="pre">deploy/</span></code> directory under your
account, and using <a class="reference external" href="https://github.mit.edu/mitlibraries/wordpress_deployment">the deploy scripts for plugins and themes</a> that we have
written.</p>
<p>The steps to upgrade a locally-written project look like this:</p>
<ol class="simple">
<li><p>Check out the project/branch you are upgrading into <code class="docutils literal notranslate"><span class="pre">~/deploy/$project-name</span></code></p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">git</span><span class="nd">@github</span><span class="o">.</span><span class="n">com</span><span class="p">:</span><span class="n">MITLibraries</span><span class="o">/</span><span class="n">wp</span><span class="o">-</span><span class="n">plugin</span><span class="o">-</span><span class="n">template</span><span class="o">.</span><span class="n">git</span> <span class="o">~/</span><span class="n">deploy</span><span class="o">/</span><span class="n">wp</span><span class="o">-</span><span class="n">plugin</span><span class="o">-</span><span class="n">template</span>
</pre></div>
</div>
<ol class="simple">
<li><p>If needed, install/run grunt to build</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> ~/deploy/wp-plugin-template
scl <span class="nb">enable</span> rh-nodejs8 /bin/bash
npm install
grunt
</pre></div>
</div>
<ol class="simple">
<li><p>Run the relevant deploy script, passing the project name as arguments. If
you have not placed the deploy script into your deploy directory already, you
can symlink it from <code class="docutils literal notranslate"><span class="pre">/usr/local/scripts/</span></code>.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">~/</span><span class="n">deploy</span><span class="o">/</span>
<span class="o">./</span><span class="n">deploy</span><span class="o">-</span><span class="n">plugin</span><span class="o">.</span><span class="n">sh</span> <span class="n">wp</span><span class="o">-</span><span class="n">plugin</span><span class="o">-</span><span class="n">template</span> <span class="n">wp</span><span class="o">-</span><span class="n">plugin</span><span class="o">-</span><span class="n">template</span>
</pre></div>
</div>
</section>
<section id="template-projects">
<h3>Template projects<a class="headerlink" href="#template-projects" title="Permalink to this headline">¶</a></h3>
<p>We have created a reference project that includes the recommended tooling
integrations and code standards:</p>
<p><a class="reference external" href="https://github.com/MITLibraries/wp-plugin-template">Plugin Template</a></p>
</section>
</section>
<section id="integrations">
<h2>Integrations<a class="headerlink" href="#integrations" title="Permalink to this headline">¶</a></h2>
<p>Integrations between Wordpress and external systems are needed for some
functionality. Some of these integrations are covered elsewhere in this
documentation (<a class="reference external" href="https://mitlibraries.github.io/guides/misc/exception_monitoring.html">exception monitoring</a> and <a class="reference external" href="https://mitlibraries.github.io/guides/misc/logging.html">centralized logging</a>, for example).</p>
<p>Other integrations that are more specific to WordPress are detailed below.</p>
<section id="zapier-airtable-and-webforms">
<h3>Zapier / Airtable and webforms<a class="headerlink" href="#zapier-airtable-and-webforms" title="Permalink to this headline">¶</a></h3>
<p>Web forms on libraries.mit.edu should be built and maintained using the
Contact Forms 7 (CF7) plugin. <a class="reference external" href="https://wikis.mit.edu/confluence/display/UXWS/Step+1%3A+Create+the+form">Documentation for this can be found on the UX
wiki.</a> By design, this system keeps no record of submissions within WordPress.
The forms send emails, and the receiving system is responsible for tracking
the submission.</p>
<p>A small number of forms, however, do not work via email. Those forms instead
send submissions via webhook to Zapier, which in turn sends them to Airtable
for processing.</p>
<p>The Zapier account which stores this workflow is controlled by UX, with some
assistance from EngX. Some details are stored within the WordPress form UI,
while the Zapier UI controls the crosswalk between the form and Airtable.</p>
<p>The Airtable bases are constructed and maintained by each form owner. As of
this writing, Distinctive Collections is the only area of the Libraries which
uses this setup.</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Guides</a></h1>








<h3>Navigation</h3>
<p><span class="caption-text">Start Here</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../basics/a11y.html">Accessibility / a11y</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basics/github.html">GitHub</a></li>
</ul>
<p><span class="caption-text">How We Work Together</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../collaboration/pairing.html">Pair programming</a></li>
</ul>
<p><span class="caption-text">Languages and Frameworks</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="python.html">Python Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="rails.html">Rails at MIT Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="vuejs.html">Vue.js at MIT Libraries</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">WordPress at MIT Libraries</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#deployments">Deployments</a></li>
<li class="toctree-l2"><a class="reference internal" href="#upgrading">Upgrading</a></li>
<li class="toctree-l2"><a class="reference internal" href="#database-migrations">Database migrations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#locally-developed-code">Locally Developed Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="#integrations">Integrations</a></li>
</ul>
</li>
</ul>
<p><span class="caption-text">Authentication</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../authentication/oauth.html">OAuth at MIT (deprecated)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authentication/touchstone_saml.html">Touchstone / Shibboleth / SAML</a></li>
</ul>
<p><span class="caption-text">Deployment</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../deploy/airflow.html">Airflow: workflow engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deploy/aws-2.0.html">AWS Organization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deploy/cicd.html">Continuous Integration/Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deploy/heroku.html">Heroku</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deploy/heroku_checklist.html">Heroku Launch Checklist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deploy/legacy-aws.html">Working with AWS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deploy/legacy-terraform.html">Terraform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deploy/pantheon.html">Pantheon</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deploy/terraform-1.0.html">Terraform</a></li>
</ul>
<p><span class="caption-text">Everything else</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../misc/adr.html">Architecture Decision Records</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/docker.html">Containerizing Your App</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/exception_monitoring.html">Exception Monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/incident_response.html">Incident Response Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/logging.html">Central Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/matomo.html">Configuring Matomo for analytics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/proxy_urls.html">Proxy URLs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/ssl.html">SSL Encryption</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="vuejs.html" title="previous chapter">Vue.js at MIT Libraries</a></li>
      <li>Next: <a href="../authentication/oauth.html" title="next chapter">OAuth at MIT (deprecated)</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, MIT Libraries.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.2.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/languages/wordpress.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>